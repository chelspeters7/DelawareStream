library(dataRetrieval)
library(ggplot2)
library(forecast)
library(plyr)
library(dplyr)
require(stats)
setwd("C:/Users/Admin/Desktop/Chelsea/Projects/DelawareStream/Script")
setwd('..')
source("Script/StreamFunctions.R")
source("Script/BFI.r")
# Discharge sites
sitesd <- whatNWISsites(bBox=c(-77.9,36.5,-72.6,41.0),
parameterCd=c("00060"),
hasDataTypeCd="dv")
dis <- sitesd$site_no
# Salinity sites
sitess <- whatNWISsites(bBox=c(-77.9,36.5,-72.6,41.0),
parameterCd=c("00095"),
hasDataTypeCd="dv")
spc <- sites$site_no
# Good sites
sites <- spc[(spc %in% dis)]
parameterCd <- "all"
startDate <- "1950-01-01"
endDate <- "2019-06-01"
spc <- sitess$site_no
# Good sites
sites <- spc[(spc %in% dis)]
parameterCd <- "all"
startDate <- "1950-01-01"
endDate <- "2019-06-01"
count = 1
# Determine site number
siteNumber = sites[count]
# Find salinity and discharge given siteNumber, parameterCd, startDate, and endDate.
SC_D <- readNWISdv(siteNumber, parameterCd, startDate, endDate)
SC_D <- stream.cleandf(SC_D)
#Information about the data frame attributes:
statInfo <- attr(SC_D, "statisticInfo")
variableInfo <- attr(SC_D, "variableInfo")
siteInfo <- attr(SC_D, "siteInfo")
parameterscodes <- variableInfo$variableCode
View(SC_D)
View(SC_D)
SC_D <- readNWISdata(siteNumber, parameterCd, startDate, endDate)
SC_D_info <- readNWISsite(siteNumber)
View(SC_D_info)
# Find salinity and discharge given siteNumber, parameterCd, startDate, and endDate.
SC_D <- readNWISdv(siteNumber, parameterCd, startDate, endDate)
SC_D_info <- readNWISsite(siteNumber)
SC_D <- stream.cleandf(SC_D)
#Information about the data frame attributes:
statInfo <- attr(SC_D, "statisticInfo")
variableInfo <- attr(SC_D, "variableInfo")
siteInfo <- attr(SC_D, "siteInfo")
parameterscodes <- variableInfo$variableCode
comment(siteInfo)
comment(SC_D_info)
statInfo <- attr(SC_D, "statisticInfo")
variableInfo <- attr(SC_D, "variableInfo")
siteInfo <- attr(SC_D, "siteInfo")
parameterscodes <- variableInfo$variableCode
if("00095" %in% variableInfo$variableCode){
# Output to CSV
df <- data.frame("No" = SC_D$site_no, "Date" = SC_D$Date, "Flow" = SC_D$Flow, "SpC" = SC_D$SpecCond,
"Lat" = SC_D_info$dec_lat_va, "Long" = SC_D_info$dec_long_va, "Drain" = SC_D_info$drain_area_va)
filename = paste("Data/",siteInfo$site_no,".csv",sep="")
write.csv(df, file = filename)
# Plot
par(mar=c(5,5,5,5)) #sets the size of the plot window
plot(SC_D$Date, SC_D$SpecCond,col="red",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "00095")],
xlab="" )
par(new=TRUE)
plot(SC_D$Date, SC_D$Flow,col="black",xaxt="n",yaxt="n",xlab="",ylab="",axes=FALSE)
stream.PlotText.noeq(SC_D, "00060")
}
write.csv(df, file = filename, na = "")
# Plot
par(mar=c(5,5,5,5)) #sets the size of the plot window
plot(SC_D$Date, SC_D$SpecCond,col="red",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "00095")],
xlab="" )
par(new=TRUE)
plot(SC_D$Date, SC_D$Flow,col="black",xaxt="n",yaxt="n",xlab="",ylab="",axes=FALSE)
stream.PlotText.noeq(SC_D, "00060")
# Discharge sites
sitesd <- whatNWISsites(bBox=c(-77.9,36.5,-72.6,41.0),
parameterCd=c("00060"),
hasDataTypeCd="dv")
dis <- sitesd$site_no
# Salinity sites
sitess <- whatNWISsites(bBox=c(-77.9,36.5,-72.6,41.0),
parameterCd=c("00095"),
hasDataTypeCd="dv")
spc <- sitess$site_no
# Good sites
sites <- spc[(spc %in% dis)]
parameterCd <- "all"
startDate <- "1950-01-01"
endDate <- "2019-06-01"
for (count in 1:6) {
#count = 1
# Determine site number
siteNumber = sites[count]
# Find salinity and discharge given siteNumber, parameterCd, startDate, and endDate.
SC_D <- readNWISdv(siteNumber, parameterCd, startDate, endDate)
SC_D_info <- readNWISsite(siteNumber)
SC_D <- stream.cleandf(SC_D)
#Information about the data frame attributes:
statInfo <- attr(SC_D, "statisticInfo")
variableInfo <- attr(SC_D, "variableInfo")
siteInfo <- attr(SC_D, "siteInfo")
parameterscodes <- variableInfo$variableCode
if("00095" %in% variableInfo$variableCode){
# Output to CSV
df <- data.frame("No" = SC_D$site_no, "Date" = SC_D$Date, "Flow" = SC_D$Flow, "SpC" = SC_D$SpecCond,
"Lat" = SC_D_info$dec_lat_va, "Long" = SC_D_info$dec_long_va, "Drain" = SC_D_info$drain_area_va)
filename = paste("Data/",siteInfo$site_no,".csv",sep="")
write.csv(df, file = filename, na = "")
# Plot
par(mar=c(5,5,5,5)) #sets the size of the plot window
plot(SC_D$Date, SC_D$SpecCond,col="red",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "00095")],
xlab="" )
par(new=TRUE)
plot(SC_D$Date, SC_D$Flow,col="black",xaxt="n",yaxt="n",xlab="",ylab="",axes=FALSE)
stream.PlotText.noeq(SC_D, "00060")
qr}
}
comment(SC_D_info)
View(SC_D_info)
View(SC_D_info)
plot(SC_D$Date, SC_D$Flow,col="black", type = "l",xaxt="n",yaxt="n",xlab="",ylab="",axes=FALSE)
for (count in 10:13) {
#count = 1
# Determine site number
siteNumber = sites[count]
# Find salinity and discharge given siteNumber, parameterCd, startDate, and endDate.
SC_D <- readNWISdv(siteNumber, parameterCd, startDate, endDate)
SC_D_info <- readNWISsite(siteNumber)
SC_D <- stream.cleandf(SC_D)
#Information about the data frame attributes:
statInfo <- attr(SC_D, "statisticInfo")
variableInfo <- attr(SC_D, "variableInfo")
siteInfo <- attr(SC_D, "siteInfo")
parameterscodes <- variableInfo$variableCode
if("00095" %in% variableInfo$variableCode){
# Output to CSV
df <- data.frame("No" = SC_D$site_no, "Date" = SC_D$Date, "Flow" = SC_D$Flow, "SpC" = SC_D$SpecCond,
"Lat" = SC_D_info$dec_lat_va, "Long" = SC_D_info$dec_long_va, "Drain" = SC_D_info$drain_area_va)
filename = paste("Data/",siteInfo$site_no,".csv",sep="")
write.csv(df, file = filename, na = "")
# Plot
par(mar=c(5,5,5,5)) #sets the size of the plot window
plot(SC_D$Date, SC_D$SpecCond,col="red",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "00095")],
xlab="" )
par(new=TRUE)
plot(SC_D$Date, SC_D$Flow,col="black", type = "l",xaxt="n",yaxt="n",xlab="",ylab="",axes=FALSE)
stream.PlotText.noeq(SC_D, "00060")
}
}
View(SC_D)
View(SC_D)
# Extract and plot baseflow
library(dataRetrieval)
library(ggplot2)
library(forecast)
library(plyr)
library(dplyr)
require(stats)
library(lfstat)
setwd("C:/Users/Admin/Desktop/Chelsea/Projects/DelawareStream/Script")
setwd('..')
source("Script/StreamFunctions.R")
source("Script/BFI.r")
#==========================================================
# Download discharge data
siteNumber <- "01484085"
parameterCd <- "all"
startDate <- "2018-03-04"
endDate <- "2018-12-31" #"2019-06-01"
# Find salinity and discharge given siteNumber, parameterCd, startDate, and endDate.
SC_D <- readNWISdv(siteNumber, parameterCd, startDate, endDate)
SC_D <- stream.cleandf(SC_D)
df <- data.frame("date" = SC_D$Date, "day" = SC_D$day, "month" = SC_D$month, "year" = SC_D$year,
"flow" = SC_D$X_72137, "hyear" = SC_D$year)
# Information about the data frame attributes:
statInfo <- attr(SC_D, "statisticInfo")
variableInfo <- attr(SC_D, "variableInfo")
siteInfo <- attr(SC_D, "siteInfo")
parameterscodes <- variableInfo$variableCode
# Plot the data
plot(SC_D$Date, SC_D$X_72137,col="black",type = "l",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "72137")],
xlab="Date")
# Extract and plot baseflow
library(dataRetrieval)
#==========================================================
# Download discharge data
siteNumber <- "01484085"
parameterCd <- "all"
startDate <- "2018-03-04"
endDate <- "2018-12-31" #"2019-06-01"
# Find salinity and discharge given siteNumber, parameterCd, startDate, and endDate.
SC_D <- readNWISdv(siteNumber, parameterCd, startDate, endDate)
SC_D <- stream.cleandf(SC_D)
View(SC_D)
# Find salinity and discharge given siteNumber, parameterCd, startDate, and endDate.
SC_D <- readNWISdv(siteNumber, parameterCd, startDate, endDate)
#==========================================================
# Download discharge data
siteNumber <- "01484080"
parameterCd <- "all"
startDate <- "2018-03-04"
startDate <- "2017-03-04"
endDate <- "2018-12-31" #"2019-06-01"
# Find salinity and discharge given siteNumber, parameterCd, startDate, and endDate.
SC_D <- readNWISdv(siteNumber, parameterCd, startDate, endDate)
View(SC_D)
#==========================================================
# Download discharge data
siteNumber <- "01484085"
# Find salinity and discharge given siteNumber, parameterCd, startDate, and endDate.
SC_D <- readNWISdv(siteNumber, parameterCd, startDate, endDate)
#==========================================================
# Download discharge data
siteNumber <- "01484080"
# Find salinity and discharge given siteNumber, parameterCd, startDate, and endDate.
SC_D <- readNWISdv(siteNumber, parameterCd, startDate, endDate)
SC_D <- stream.cleandf(SC_D)
df <- data.frame("date" = SC_D$Date, "day" = SC_D$day, "month" = SC_D$month, "year" = SC_D$year,
"flow" = SC_D$X_72137, "hyear" = SC_D$year)
SC_D_info <- readNWISsite(siteNumber)
# Information about the data frame attributes:
statInfo <- attr(SC_D, "statisticInfo")
variableInfo <- attr(SC_D, "variableInfo")
siteInfo <- attr(SC_D, "siteInfo")
parameterscodes <- variableInfo$variableCode
# Plot the data
plot(SC_D$Date, SC_D$X_72137,col="black",type = "l",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "72137")],
xlab="Date")
bf <- BaseflowSeparation(SC_D$X_72137, filter_parameter = 0.925, passes = 3)
endDate <- "2018-01-31" #"2019-06-01"
# Find salinity and discharge given siteNumber, parameterCd, startDate, and endDate.
SC_D <- readNWISdv(siteNumber, parameterCd, startDate, endDate)
SC_D <- stream.cleandf(SC_D)
df <- data.frame("date" = SC_D$Date, "day" = SC_D$day, "month" = SC_D$month, "year" = SC_D$year,
"flow" = SC_D$X_72137, "hyear" = SC_D$year)
SC_D_info <- readNWISsite(siteNumber)
# Information about the data frame attributes:
statInfo <- attr(SC_D, "statisticInfo")
variableInfo <- attr(SC_D, "variableInfo")
siteInfo <- attr(SC_D, "siteInfo")
parameterscodes <- variableInfo$variableCode
# Plot the data
plot(SC_D$Date, SC_D$X_72137,col="black",type = "l",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "72137")],
xlab="Date")
bf <- BaseflowSeparation(SC_D$X_72137, filter_parameter = 0.925, passes = 3)
plot(SC_D$Date, bf, col = "red")
plot(SC_D$Date, bf$bt, col = "red")
# Plot the data
plot(SC_D$Date, SC_D$X_72137,col="black",type = "l",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "72137")],
xlab="Date")
bf <- BaseflowSeparation(SC_D$X_72137, filter_parameter = 0.925, passes = 3)
par(new=TRUE)
plot(SC_D$Date, bf$bt, col = "red")
plot(SC_D$Date, bf$qft, col = "red")
# Plot the data
plot(SC_D$Date, SC_D$X_72137,col="black",type = "l",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "72137")],
xlab="Date")
bf <- BaseflowSeparation(SC_D$X_72137, filter_parameter = 0.925, passes = 3)
par(new=TRUE)
plot(SC_D$Date, bf$qft, col = "red")
plot(SC_D$Date, bf$qft, col = "red",xaxt="n",yaxt="n",xlab="",ylab="",axes=FALSE)
# Plot the data
plot(SC_D$Date, SC_D$X_72137,col="black",type = "l",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "72137")],
xlab="Date")
bf <- BaseflowSeparation(SC_D$X_72137, filter_parameter = 0.925, passes = 3)
par(new=TRUE)
plot(SC_D$Date, bf$qft, col = "red",xaxt="n",yaxt="n",xlab="",ylab="",axes=FALSE)
plot(SC_D$Date, SC_D$X_72137,col="black",type = "l",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "72137")],
xlab="Date")
#==========================================================
# Baseflow seperation
bf <- BaseflowSeparation(SC_D$X_72137, filter_parameter = 0.925, passes = 3)
par(new=TRUE)
plot(SC_D$Date, bf$bt, col = "red",xaxt="n",yaxt="n",xlab="",ylab="",axes=FALSE)
plot(SC_D$Date, bf$bt, col = "red",xaxt="n",yaxt="n",xlab="",ylab="",axes=FALSE)
plot(SC_D$Date, bf$bt)
plot(SC_D$Date, SC_D$X_72137,col="black",type = "l",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "72137")],
xlab="Date")
#==========================================================
# Baseflow seperation
bf <- BaseflowSeparation(SC_D$X_72137, filter_parameter = 0.925, passes = 3)
#par(new=TRUE)
lines(SC_D$Date, bf$bt, col = "red",xaxt="n",yaxt="n",xlab="",ylab="",axes=FALSE)
#par(new=TRUE)
lines(SC_D$Date, bf$bt, col = "red")
plot(SC_D$Date, SC_D$X_72137,col="black",type = "l",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "72137")],
xlab="Date")
#==========================================================
# Baseflow seperation
bf <- BaseflowSeparation(SC_D$X_72137, filter_parameter = 0.925, passes = 3)
#par(new=TRUE)
lines(SC_D$Date, bf$bt, col = "red")
lines(SC_D$Date, bf$qft, col = "green")
lines(SC_D$Date, bf$qft-bf$bf, col = "green")
abc = bf$qft+bf$bf
lines(SC_D$Date, abc, col = "green")
abc = as.numeric(as.character(bf$qft)) + as.numeric(as.character(bf$bt))
lines(SC_D$Date, abc, col = "green")
plot(SC_D$Date, SC_D$X_72137,col="black",type = "l",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "72137")],
xlab="Date")
#==========================================================
# Baseflow seperation
bf <- BaseflowSeparation(SC_D$X_72137, filter_parameter = 0.925, passes = 3)
#par(new=TRUE)
lines(SC_D$Date, bf$bt, col = "red")
abc = as.numeric(as.character(bf$qft)) + as.numeric(as.character(bf$bt))
lines(SC_D$Date, abc, col = "green")
plot(SC_D$Date, SC_D$X_72137,col="black",type = "l",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "72137")],
xlab="Date")
lines(SC_D$Date, bf$bt, col = "red")
#abc = as.numeric(as.character(bf$qft)) + as.numeric(as.character(bf$bt))
#lines(SC_D$Date, abc, col = "green")
par(new=TRUE)
plot(SC_D$Date, SC_D$SpecCond,col="red",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "00095")],
xlab="" )
# Plot the data
plot(SC_D$Date, SC_D$X_72137,col="black",type = "l",
ylab=variableInfo$variableDescription[which(variableInfo$variableCode == "72137")],
xlab="Date")
lines(SC_D$Date, bf$bt, col = "blue")
#abc = as.numeric(as.character(bf$qft)) + as.numeric(as.character(bf$bt))
#lines(SC_D$Date, abc, col = "green")
par(new=TRUE)
plot(SC_D$Date, SC_D$SpecCond,col="red",
type = "l",xaxt="n",yaxt="n",xlab="",ylab="",axes=FALSE)
